{% load static %}
<!DOCTYPE html>

<html>
  <head>
    <title>Cricket Scoring Application</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $(document).ready(function () {
    $('#batsman-select-a').change(function () {
        var selectedBatter = $(this).val();
        var batterRow = '<tr class="batter-row" data-batter-name="' + selectedBatter + '">' +
            '<td>' + selectedBatter + '</td>' +
            '<td class="batter-runs">0</td>' +
            '<td class="balls-faced">0</td>' +
            '<td class="fours">0</td>' +
            '<td class="sixes">0</td>' +
            '<td class="strike-rate">0.00</td>' +
            '</tr>';
        $('#batters-container-a tbody').append(batterRow);
    });
});



//score for team b
$(document).ready(function() {
  $('#batsman-select-b').change(function() {
    var selectedBatter = $(this).val();
    var batterRow = $('#batters-container-b tbody').find('tr[data-batter-name="' + selectedBatter + '"]');

    if (batterRow.length == 0) {
      batterRow = '<tr class="batter-row-b" data-batter-name="' + selectedBatter + '" data-team="B">' +
                      '<td >' + selectedBatter + '</td>' +
                      '<td class="batter-runs">0</td>' +
                      '<td class="balls-faced">0</td>' +
                      '<td class="fours">0</td>' +
                      '<td class="sixes">0</td>' +
                      '<td class="strike-rate">0.00</td>' +
                  '</tr>';
      $('#batters-container-b tbody').append(batterRow);
    }
  });
});

    </script>

    <link
      rel="stylesheet"
      type="text/css"
      href="{% static 'scoring/scoring.css' %}"
    />
    <style>
      #tournament_name {
        font-weight: bold;
      }
   
    </style>
  </head>
  <body>

    <!-- Navbar -->

    <nav class="navbar">
      <a class="active" href="{% url 'score'%}">CricScorer</a>
      <a href="#">Live Score</a>
      <a href="#">Matches</a>
      <a href="#">Teams</a>
      <a href="#">Players</a>
    </nav>

    <div id="teams">
      <div id="Matchid" data-match-id="{{ match.id }}">
        Match ID:- {{match.id}} 
        <br />
        <span name="tournament_name" id="tournament_name"
          >tournament :{{tournaments}}</span
        >

       
      </div>

      <h2>Teams Playing:</h2>
      <ul>
        <li>{{ match.team_1 }}</li>
        <li>VS</li>
        <li>{{ match.team_2 }}</li>
      </ul>
    </div>
    <div id="teams">
      <ul>
        <li>
          <span name="team-a-name" id="team-a-name">{{ match.team_1 }}</span> -
          <span name="team-a-runs" id="team-a-runs">0</span><span> /</span>
          <span id="team-a-wickets">0</span> runs
        </li>

        <li>
          <span name="team-b-name" id="team-b-name">{{ match.team_2 }}</span> -
          <span name="team-b-runs" id="team-b-runs">0</span> <span> /</span>
          <span id="team-b-wickets">0</span> runs
        </li>
      </ul>
    </div>
    <span style="padding-left: 800px">Target: <span id="Target">0</span></span>
    <span style="padding-left: 40px">winner: <span id="winner_id">None</span></span>

    <div id="overs">
      <ul>
        <li>From 0.0/0.0 Overs</li>
      </ul>
    </div>
    {% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}


<div style="display: flex;">
  <h1 style="margin-right: 50vh; margin-left: 5vh;">1st Innings</h1>
  <h1>2nd Innings</h1>
</div>

 <!-- Team-A Batters -->
<div class="container">
  <div id="batters-container-a" class="batters-container" >
    <h2>{{team_a}} Stats:</h2>
    <table>
      <tr>
        <td colspan="6">
          <label for="batsman-select">Select Batsman:</label>
          <select name="batsman-select-a" id="batsman-select-a">
            {% for batter in team_a_batters %}
            <option value="{{ batter.name }}">{{ batter.name }}</option>
            {% endfor %}
          </select>
        </td>
      </tr>
      <tr>
        <th>Player Name</th>
        <th>Runs</th>
        <th>Balls Faced</th>
        <th>Fours</th>
        <th>Sixes</th>
        <th>Strike Rate</th>
      </tr>
    
    </table>
  </div>



 <!-- Team-B Batters -->
      <div id="batters-container-b"  class="batters-container">
        <h2>{{team_b}} Stats:</h2>
        <table>
          <tr>
            <td colspan="6">
              <label for="batsman-select">Select Batsman:</label>
              <select name="batsman-select-b" id="batsman-select-b">
                {% for batter in team_b_batters %}
                <option value="{{ batter.name }}">{{ batter.name }}</option>
                {% endfor %}
              </select>
            </td>
          </tr>
          <tr>
            <th>Player Name</th>
            <th>Runs</th>
            <th>Balls Faced</th>
            <th>Fours</th>
            <th>Sixes</th>
            <th>Strike Rate</th>
          </tr>
        
        </table>
    </div>

     <!-- Team-A Bowlers -->
    <div id="bowlers-container-b"  class="batters-container">
      <h2>{{team_b}} Bowlers Stats:</h2>
      <table>
        <tr>
          <td colspan="6">
            <label for="bowler-select">Select Bowler:</label>
            <select name="bowler-select-a" id="bowler-select-a">
              {% for bowler in team_b_bowlers %}
              <option value="{{ bowler.name }}">{{ bowler.name }}</option>
              {% endfor %}
            </select>
          </td>
        </tr>
        <tr>
          <th>Player Name</th>
          <th>Overs</th>
          <th>Runs</th>
          <th>Wickets</th>
          <th>Economy</th>
        </tr>
        <tbody>
          
          {% for bowler in team_b_bowlers %}
          <tr class="bowler-row" data-bowler-name="{{ bowler.name }}">
            <td>{{ bowler.name }}</td>
            <td class="bowler-overs">0.0</td>
            <td class="bowler-runs">0</td>
            <td class="bowler-wickets">0</td>
            <td class="bowler-economy">0.00</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
  </div>
    
   <!-- Team-B Bowlers -->
  <div id="batters-container-b'"  class="batters-container">
    <h2>{{team_a}} Bowlers Stats:</h2>
    <table>
      <tr>
        <td colspan="6">
          <label for="bowler-select">Select Bowler:</label>
          <select name="bowler-select-b" id="bowler-select-b">
            {% for bowler in team_a_bowlers %}
            <option value="{{ bowler.name }}">{{ bowler.name }}</option>
            {% endfor %}
          </select>
        </td>
      </tr>
      <tr>
        <th>Player Name</th>
        <th>Overs</th>
        <th>Runs</th>
        <th>Wickets</th>
        <th>Economy</th>
      </tr>
      <tbody>
        
        {% for bowler in team_a_bowlers %}
        <tr class="bowler-row-b" data-bowler-name="{{ bowler.name }}">
          <td>{{ bowler.name }}</td>
          <td class="bowler-overs">0.0</td>
          <td class="bowler-runs">0</td>
          <td class="bowler-wickets">0</td>
          <td class="bowler-economy">0.00</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
</div>
    <div id="message"></div>

    <div>
      <div class="container"></div>
      <h1>Press Buttons below to score:</h1>
      <div id="score-buttons">
        <button onclick="score(0)">0</button>
        <button onclick="score(1)">1</button>
        <button onclick="score(2)">2</button>
        <button onclick="score(3)">3</button>
        <button onclick="score(4)">4</button>
        <button onclick="score(5)">5</button>
        <button onclick="score(6)">6</button>
        <button onclick="widenNoball()">Wide</button>
        <button onclick="widenNoball()">NO BALL</button>
        <button onclick="score(1)">LEG BYES</button>
        <button onclick="score(1)">BYES</button>
        <button onclick="wicket()">wicket</button>
      </div>
    </div>

    <div id="editing-buttons">
      <button onclick="Strikerchange()">Strikerchange</button>
      <button onclick="ChangeBowler()">ChangeBowler</button>
      <!-- <button onclick="VerifyScore()">VerifyScore</button> -->
      <!-- <button onclick="Undo()">Undo</button> -->
      <button onclick="displayWinner()">EndInnings</button>

      <!-- <form method="POST" action="{% url 'add_score' match_id=match.id %}">
        {% csrf_token %}
        <label for="team_a_runs">Team A Runs:</label>
        <input type="number" name="team_a_runs" id="team_a_runs" />

        <label for="team_b_runs">Team B Runs:</label>
        <input type="number" name="team_b_runs" id="team_b_runs" />

        <button type="submit">Add Score</button>
      </form> -->
      <button id="add-score-button">Add Score</button>
    </div>
    <div id="myModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <span class="close">&times;</span>
        <p id="modal-message"></p>
      </div>
    </div>
  </body>
</html>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Add an event listener to the "Add Score" button -->

<script>
  $(document).ready(function () {
    $("#add-score-button").click(function () {
      // Get the values of the "team-a-runs" and "team-b-runs" span elements
      var teamARuns = $("#team-a-runs").text();
      var teamBRuns = $("#team-b-runs").text();

      // Send the values to the server using an AJAX request
      $.ajax({
        url: "{% url 'add_score' match_id=match.id %}",
        method: "POST",
        data: {
          team_a_runs: teamARuns,
          team_b_runs: teamBRuns,
          csrfmiddlewaretoken: "{{ csrf_token }}",
        },
        success: function (response) {
          // Handle the server response here
        },
        error: function (xhr, status, error) {
          // Handle errors here
        },
      });
    });
  });

 
</script>


<script src="{% static 'js/scoring.js' %}"></script>

